<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Lectura</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Pantalla de Login -->
    <div id="loginScreen" class="screen active">
        <div class="container">
            <h1>Juego de Lectura</h1>
            <div class="login-form">
                <h2>Iniciar Sesión</h2>
                <input type="text" id="loginUser" placeholder="Usuario" value="USER">
                <input type="password" id="loginPass" placeholder="Contraseña" value="123">
                <button onclick="login()">Entrar</button>
                <p><a href="#" onclick="showRegister()">¿No tienes cuenta? Regístrate</a></p>
            </div>
        </div>
    </div>

    <!-- Pantalla de Registro -->
    <div id="registerScreen" class="screen">
        <div class="container">
            <h2>Registro de Usuario</h2>
            <div class="register-form">
                <input type="text" id="regDni" placeholder="DNI" maxlength="8">
                <input type="text" id="regNombres" placeholder="Nombres">
                <input type="text" id="regApellidos" placeholder="Apellidos">
                <select id="regGenero">
                    <option value="">Seleccionar Género</option>
                    <option value="masculino">Masculino</option>
                    <option value="femenino">Femenino</option>
                    <option value="otro">Otro</option>
                </select>
                <button onclick="register()">Registrarse</button>
                <p><a href="#" onclick="showLogin()">¿Ya tienes cuenta? Inicia sesión</a></p>
            </div>
        </div>
    </div>

    <!-- Panel de Admin -->
    <div id="adminScreen" class="screen">
        <div class="container">
            <div class="admin-header">
                <h2>Panel de Administrador - Leonardo</h2>
                <div class="admin-actions">
                    <button onclick="exportData()" class="export-btn">📥 Exportar</button>
                    <button onclick="importData()" class="import-btn">📤 Importar</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleFileImport(event)">
                    <button onclick="logout()" class="logout-btn">Cerrar Sesión</button>
                </div>
            </div>
            
            <div class="admin-panel">
                <!-- Gestión de categorías mejorada -->
                <div class="section category-management">
                    <h3>📚 Gestión de Categorías</h3>
                    <div class="category-grid">
                        <div class="category-list">
                            <h4>Categorías Disponibles</h4>
                            <div id="categoriesList" class="categories-container">
                                <!-- Las categorías se cargarán aquí -->
                            </div>
                        </div>
                        <div class="category-form">
                            <h4>Nueva Categoría</h4>
                            <input type="text" id="newCategoryName" placeholder="Nombre (ej: Biología, Historia)">
                            <button onclick="createCategory()" class="create-btn">➕ Crear Categoría</button>
                        </div>
                    </div>
                </div>
                
                <!-- Gestión de sala mejorada -->
                <div class="section room-management">
                    <h3>🎯 Control de Sala</h3>
                    <div class="room-info">
                        <div class="selected-category">
                            <strong>Categoría Activa:</strong> 
                            <span id="selectedCategoryName">Ninguna seleccionada</span>
                        </div>
                        <div class="code-status">
                            <div class="code-display">
                                <strong>Código Actual:</strong> 
                                <span id="currentRoomCode" class="room-code">-</span>
                            </div>
                            <div class="time-display">
                                <strong>Tiempo Restante:</strong> 
                                <span id="codeTimeLeft" class="time-left">-</span>
                            </div>
                        </div>
                        <button onclick="generateRoomCode()" id="generateCodeBtn" class="generate-btn" disabled>
                            🚀 Generar Código (5 min)
                        </button>
                    </div>
                </div>
                
                <!-- Editor de contenido mejorado -->
                <div class="section content-editor" id="contentEditor" style="display: none;">
                    <h3>✏️ Editor de Contenido</h3>
                    <div class="editor-tabs">
                        <button class="tab-btn active" onclick="showTab('text')">📖 Texto de Lectura</button>
                        <button class="tab-btn" onclick="showTab('questions')">❓ Preguntas</button>
                    </div>
                    
                    <div id="textTab" class="tab-content active">
                        <div class="text-editor">
                            <label>Texto para leer (60 segundos):</label>
                            <textarea id="readingText" rows="8" placeholder="Ingresa el texto que los estudiantes deberán leer..."></textarea>
                            <div class="text-stats">
                                <span id="textLength">0 caracteres</span> | 
                                <span id="readingTimeEst">~0 min lectura</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="questionsTab" class="tab-content">
                        <div class="questions-header">
                            <h4>Preguntas de Comprensión</h4>
                            <button onclick="adminController.addQuestion()" class="add-question-btn">➕ Agregar Pregunta</button>
                        </div>
                        <div id="questionsContainer" class="questions-container">
                            <!-- Las preguntas se cargarán aquí -->
                        </div>
                    </div>
                    
                    <div class="editor-actions">
                        <button onclick="saveAdminData()" class="save-btn">💾 Guardar Cambios</button>
                        <button onclick="previewContent()" class="preview-btn">👁️ Vista Previa</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pantalla de Ingreso a Sala -->
    <div id="roomScreen" class="screen">
        <div class="container">
            <h2>Ingresar a Sala</h2>
            <div class="room-form">
                <input type="text" id="userDni" placeholder="Tu DNI">
                <input type="text" id="roomCode" placeholder="Código de Sala">
                <button onclick="joinRoom()">Ingresar a Sala</button>
                <button onclick="logout()">Cerrar Sesión</button>
            </div>
        </div>
    </div>

    <!-- Pantalla de Lectura -->
    <div id="readingScreen" class="screen">
        <div class="container">
            <h2>Tiempo de Lectura</h2>
            <div class="timer">Tiempo restante: <span id="timeLeft">60</span> segundos</div>
            <div id="textContainer" class="text-container">
                <p id="readingTextDisplay"></p>
            </div>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- Pantalla de Preguntas -->
    <div id="questionsScreen" class="screen">
        <div class="container">
            <h2>Preguntas</h2>
            <div id="questionsDisplay">
                <!-- Las preguntas se mostrarán aquí -->
            </div>
            <button id="submitAnswers" onclick="submitAnswers()" style="display: none;">Enviar Respuestas</button>
        </div>
    </div>

    <!-- Pantalla de Resultados -->
    <div id="resultsScreen" class="screen">
        <div class="container">
            <h2>Resultados</h2>
            <div id="resultsDisplay">
                <!-- Los resultados se mostrarán aquí -->
            </div>
            <button onclick="restartGame()">Jugar de Nuevo</button>
        </div>
    </div>

    <script src="admin-controller.js"></script>
    <script src="script.js"></script>
</body>
</html>
